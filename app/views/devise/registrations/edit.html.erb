<div class="auth-page">
  <div class="auth-container auth-container--wide">
    <div class="page-head">
      <h1 class="page-title">マイページ編集</h1>
      <p class="page-sub">ニックネームとメールアドレスとパスワードを変更できます。</p>
    </div>

    <div class="auth-card">
      <%= form_for(resource, as: resource_name, url: registration_path(resource_name),
               html: { method: :put }, local: true) do |f| %>
        <%= render "devise/shared/error_messages", resource: resource %>

        <div class="form-grid">
          <!-- ニックネーム -->
          <div class="field">
            <label class="label">ニックネーム</label>
            <%= f.text_field :nickname, class:"input", autocomplete:"nickname" %>
            <p class="help">&#8203;</p>
          </div>

          <!-- メールアドレス -->
          <div class="field">
            <label class="label">メールアドレス</label>
            <%= f.email_field :email, class:"input", autofocus:true, autocomplete:"email" %>
            <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
              <p class="help">確認待ち: <%= resource.unconfirmed_email %></p>
            <% else %>
              <p class="help">&#8203;</p>
            <% end %>
          </div>

          <!-- 新しいパスワード -->
          <div class="field">
            <label class="label">新しいパスワード <span class="help" style="margin-left:.25rem;">(任意)</span></label>
            <%= f.password_field :password, class:"input",
                  autocomplete:"new-password", placeholder:"変更する場合のみ入力" %>
            <% if @minimum_password_length %>
              <p class="help">※ <%= @minimum_password_length %>文字以上</p>
            <% else %>
              <p class="help">&#8203;</p>
            <% end %>
          </div>

          <!-- 確認用 -->
          <div class="field">
            <label class="label">新しいパスワード（確認）</label>
            <%= f.password_field :password_confirmation, class:"input",
                  autocomplete:"new-password", placeholder:"同じパスワードを再入力" %>
            <p class="help">&#8203;</p>
          </div>

          <!-- 現在のパスワード -->
          <div class="field">
            <label class="label">現在のパスワード <span class="help" style="margin-left:.25rem;">(更新を確定するため必須)</span></label>
            <%= f.password_field :current_password, class:"input", autocomplete:"current-password" %>
            <p class="help">※ 情報を更新するには現在のパスワードが必要です。</p>
          </div>
        </div>

        <div class="actions">
          <%= f.submit "更新する", class:"btn btn-blue", style:"width:100%;" %>
        </div>
      <% end %>

      <!-- アカウント削除 -->
      <div style="margin-top:2.5rem; border-top:1px solid var(--border); padding-top:1.25rem;">
        <h3 style="font-size:1.125rem; margin:0;">
          アカウント
          <%= link_to "削除",
            registration_path(resource_name),
            data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか？" },
            class: "link", style:"color:#dc2626;" %>
        </h3>
        <p class="page-sub" style="margin-top:.5rem;">※ 削除すると登録データは元に戻せません。</p>
      </div>

      <div style="margin-top:1.5rem; text-align:center;">
        <%= link_to "戻る", root_path, class:"link" %>
      </div>
    </div>
  </div>
</div>